<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title> 상품 소개페이지</title>
    <link rel="stylesheet" href="{{url_for('static',filename='/css/style.css')}}">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Noto+Sans+KR&display=swap" rel="stylesheet">
    <!-- JQuery를 import 합니다 -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>


<body>
    <div id = "wrap">

      <div class="page-header">
        <h1>오늘 뭐 먹었니? <small>솔직하게 적어라</small></h1>
      </div>

        <ul class="nav nav-tabs">
            <li class="nav-item">
              <a class="nav-link active" href="#">아침</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">점심</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">저녁</a>
            </li>
            <li class="nav-item">
              <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Disabled</a>
            </li>
          </ul>
          <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" id="foodname">
          <button class="btn btn-default" onclick="search_food()">Submit</button>
          </div>
          <textarea class="form-control" rows="3"></textarea>


    </div>
            <table class="table" >
            <thead>
                <tr>
                    <td> 음식</td>
                </tr>
            </thead>
            <tbody id="orderTable">
            </tbody>
        </table>
<script type="text/javascript">

        function search_food(){
        let foodname =$('#foodname').val();
        if (foodname == '') {
        alert("먹은 음식을 적으세요")
        $('#foodname').val('');
        $('#foodname').focus(); }
        $.ajax({
        type: "GET",
        url: "/search?foodname="+foodname,
        data: { },
        async: false,
        success  : function(response) {
          console.log(response['food'])
       if (response['result'] == 'success') {
          let food = response['food'];
          console.log(typeof(food))
          console.log(Object.keys(food).length)
          for (let i=0; i < Object.keys(food).length; i++) {
          food_name =food[i]['foodname'];
          console.log(food_name)
          food_portionsize =food[i]['portionsize'];
          food_foodkcal =food[i]['foodkcal'];
          make_card(food_name,food_portionsize,food_foodkcal);
          }
          }else {
          alert('데이터를 받아오지 못했습니다.');
        }}
         })
}
       function make_card(food_name, food_portionsize, food_foodkcal) {
            let temp_html = '<tr>\
                                <td>'+ food_name + '</td>\
                                <td>'+ food_portionsize + '</td>\
                                <td>'+ food_foodkcal + '</td></tr>';
            $('#orderTable').append(temp_html);
        }

</script>
</body>
</head>

</html>
